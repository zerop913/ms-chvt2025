export const httpServicesModuleData = {
  title: "Создание модуля HTTP-сервиса",
  description: "Пошаговое создание модуля HTTP-сервиса в конфигураторе 1С",

  sections: [
    {
      type: "stepList" as const,
      icon: "Settings" as const,
      title: "Предварительные условия",
      data: {
        steps: [
          { text: "Конфигуратор 1С запущен" },
          { text: 'Справочники "Категории" и "Товары" созданы' },
          { text: 'Перечисление "ЕдиницыИзмерения" настроено' },
        ],
      },
    },
    {
      type: "stepList" as const,
      icon: "Plus" as const,
      title: "Создание HTTP-сервиса",
      data: {
        steps: [
          { text: "В конфигураторе разверните дерево конфигурации" },
          { text: 'Найдите узел "HTTP-сервисы"' },
          { text: 'Щелкните правой кнопкой мыши и выберите "Добавить"' },
          { text: "Введите имя сервиса:", highlight: "ЧВТ2025API" },
          { text: "Нажмите Enter для подтверждения" },
        ],
      },
    },
    {
      type: "stepList" as const,
      icon: "Settings" as const,
      title: "Настройка свойств сервиса",
      data: {
        steps: [
          { text: "Выберите созданный HTTP-сервис в дереве" },
          {
            text: 'В окне свойств установите "Корневой URL":',
            highlight: "/api/v1",
          },
          {
            text: 'Установите "Повторное использование соединений": Использовать',
          },
          { text: "Сохраните изменения (Ctrl+S)" },
        ],
      },
    },
    {
      type: "stepList" as const,
      icon: "Code" as const,
      title: "Создание URL-шаблонов",
      data: {
        steps: [
          { text: "Разверните созданный HTTP-сервис" },
          { text: 'Щелкните правой кнопкой на "URL-шаблоны"' },
          { text: 'Выберите "Добавить" → "URL-шаблон"' },
          { text: "Создайте шаблон для товаров:", highlight: "products" },
          { text: "Создайте шаблон для категорий:", highlight: "categories" },
        ],
      },
    },
    {
      type: "codeBlock" as const,
      icon: "FileText" as const,
      title: "Структура URL-шаблонов",
      data: {
        language: "text",
        content: `HTTP-сервис: ЧВТ2025API
├── URL-шаблон: products
│   ├── HTTP-метод: GET (получение товаров)
│   ├── HTTP-метод: POST (создание товара)
│   └── HTTP-метод: PUT (обновление товара)
└── URL-шаблон: categories  
    ├── HTTP-метод: GET (получение категорий)
    ├── HTTP-метод: POST (создание категории)
    └── HTTP-метод: PUT (обновление категории)`,
      },
    },
    {
      type: "stepList" as const,
      icon: "Code" as const,
      title: "Создание HTTP-методов",
      data: {
        steps: [
          { text: 'Щелкните правой кнопкой на URL-шаблоне "products"' },
          { text: 'Выберите "Добавить" → "HTTP-метод"' },
          { text: "Установите HTTP-метод:", highlight: "GET" },
          { text: "Введите имя метода:", highlight: "ПолучитьТовары" },
          { text: "Повторите для других методов (POST, PUT)" },
        ],
      },
    },
    {
      type: "codeBlock" as const,
      icon: "Code" as const,
      title: "Пример кода для метода GET товаров",
      data: {
        language: "1c",
        content: `// HTTP-метод: GET /api/v1/products
Функция ПолучитьТовары(Запрос)
    
    // Создаем ответ
    Ответ = Новый HTTPСервисОтвет(200);
    
    // Получаем товары из справочника
    Запрос = Новый Запрос;
    Запрос.Текст = "
    |ВЫБРАТЬ
    |    Товары.Ссылка КАК Ссылка,
    |    Товары.Наименование КАК Наименование,
    |    Товары.Артикул КАК Артикул,
    |    Товары.Цена КАК Цена,
    |    Товары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
    |    Товары.Категория КАК Категория
    |ИЗ
    |    Справочник.Товары КАК Товары
    |ГДЕ
    |    НЕ Товары.ПометкаУдаления";
    
    РезультатЗапроса = Запрос.Выполнить();
    Выборка = РезультатЗапроса.Выбрать();
    
    // Формируем JSON
    МассивТоваров = Новый Массив;
    
    Пока Выборка.Следующий() Цикл
        СтруктураТовара = Новый Структура;
        СтруктураТовара.Вставить("id", Строка(Выборка.Ссылка.УникальныйИдентификатор()));
        СтруктураТовара.Вставить("name", Выборка.Наименование);
        СтруктураТовара.Вставить("article", Выборка.Артикул);
        СтруктураТовара.Вставить("price", Выборка.Цена);
        СтруктураТовара.Вставить("unit", Строка(Выборка.ЕдиницаИзмерения));
        СтруктураТовара.Вставить("categoryId", Строка(Выборка.Категория.УникальныйИдентификатор()));
        
        МассивТоваров.Добавить(СтруктураТовара);
    КонецЦикла;
    
    // Преобразуем в JSON
    ЗаписьJSON = Новый ЗаписьJSON;
    СтрокаJSON = "";
    ЗаписьJSON.УстановитьСтроку(СтрокаJSON);
    ЗаписатьJSON(ЗаписьJSON, МассивТоваров);
    
    Ответ.УстановитьТелоИзСтроки(СтрокаJSON);
    Ответ.Заголовки.Вставить("Content-Type", "application/json; charset=utf-8");
    
    Возврат Ответ;
    
КонецФункции`,
      },
    },
    {
      type: "highlightBox" as const,
      icon: "Target" as const,
      title: "Важные моменты",
      data: {
        items: [
          "Используйте уникальные идентификаторы для связи объектов",
          "Всегда устанавливайте правильный Content-Type для JSON",
          "Проверяйте входящие данные перед обработкой",
          "Обрабатывайте ошибки и возвращайте соответствующие HTTP-коды",
        ],
      },
    },
    {
      type: "stepList" as const,
      icon: "Play" as const,
      title: "Тестирование сервиса",
      data: {
        steps: [
          { text: "Сохраните конфигурацию (Ctrl+S)" },
          { text: "Обновите конфигурацию базы данных (F7)" },
          { text: "Запустите 1С в режиме предприятия" },
          {
            text: "Откройте браузер и перейдите по URL:",
            highlight: "http://localhost/api/v1/products",
          },
          { text: "Проверьте, что возвращается JSON с товарами" },
        ],
      },
    },
  ],
};
